# 🤖 Bitrix24 Telegram Bot

<div align="center">

![Python](https://img.shields.io/badge/Python-3.8+-blue?logo=python&logoColor=white)
![Aiogram](https://img.shields.io/badge/Aiogram-3.x-green?logo=telegram&logoColor=white)
![Bitrix24](https://img.shields.io/badge/Bitrix24-API-orange?logo=bitrix&logoColor=white)
![Telegram](https://img.shields.io/badge/Telegram-Bot-blue?logo=telegram&logoColor=white)

**Мощный Telegram бот для управления задачами в Bitrix24**

[Особенности](#-особенности) • [Установка](#-установка) • [Использование](#-использование) • [Команды](#-команды)

</div>

## 🌟 О проекте

Этот Telegram бот позволяет удобно работать с задачами в Bitrix24 прямо из Telegram! Создавайте задачи, просматривайте проекты и управляйте workflow без необходимости заходить в Bitrix24.

### 🎯 Возможности

- ✅ **Создание задач** через диалог или быстрые команды
- 📋 **Просмотр задач** с детальной информацией
- 👥 **Управление исполнителями** и проектами
- 🚀 **Быстрое создание** задач в одно сообщение
- 🔄 **Реальное время** - мгновенная синхронизация с Bitrix24

## 🏗️ Архитектура

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Telegram  │────│   Python    │────│   Bitrix24  │
│     Bot     │    │   Aiogram   │    │    REST     │
└─────────────┘    └─────────────┘    └─────────────┘
                         │                    │
                 ┌───────┴───────┐            │
             ┌───┴───┐       ┌───┴───┐    ┌───┴───┐
             │Handlers│       │Services│    │  База  │
             └───────┘       └───────┘    │ данных │
                                          └────────┘
```

## 📦 Установка

### 1. Клонирование и настройка

```bash
# Клонируйте репозиторий
git clone <your-repo-url>
cd bitrixPublic

# Создайте виртуальное окружение
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate  # Windows

# Установите зависимости
pip install -r requirements.txt
```

### 2. Настройка окружения

Создайте файл `.env` в корне проекта:

```env
BOT_TOKEN=your_telegram_bot_token_here
BITRIX_URL=https://your-company.bitrix24.ru/rest/1/your_secret_key/
```

### 3. Получение ключей

#### 🔐 Telegram Bot Token:
1. Напишите [@BotFather](https://t.me/BotFather) в Telegram
2. Используйте команду `/newbot`
3. Следуйте инструкциям и получите токен

#### 🔑 Bitrix24 REST API:
1. Зайдите в ваш Bitrix24 портал
2. Перейдите в **Настройки** → **Разработчикам** → **REST API**
3. Создайте новое приложение и получите URL

### 4. Запуск

```bash
python main.py
```

## 🎮 Использование

### 💬 Основные команды

| Команда | Описание | Пример |
|---------|-----------|---------|
| `/start` | Начало работы | `/start` |
| `/help` | Помощь и инструкции | `/help` |
| `/task` | Создать задачу (диалог) | `/task` |
| `/projects` | Список проектов | `/projects` |
| `/users` | Список пользователей | `/users` |
| `/gettasks` | Список задач | `/gettasks 5` |

### ⚡ Быстрое создание задачи

Отправьте сообщение в формате:

```
задача
#1 Название задачи
#2 Описание задачи
#3 ID исполнителя
#4 ID проекта (опционально)
```

Или в одну строку:
```
поставить задачу #1 Название #2 Описание #3 123 #4 456
```

## 📊 Примеры работы

### Создание задачи через диалог:
```
👤 Вы: /task
🤖 Бот: 🎯 Начинаем создание задачи. Введите название задачи:
👤 Вы: Разработать новый функционал
🤖 Бот: 📝 Теперь введите описание задачи:
👤 Вы: Нужно добавить модуль аналитики в панель управления
🤖 Бот: ✅ Задача успешно создана! ID: 157
```

### Быстрое создание:
```
👤 Вы: задача #1 Тестовая задача #2 Проверить работу бота #3 45
🤖 Бот: ✅ Задача успешно создана!
📋 Название: Тестовая задача
👤 Исполнитель: 45
🆔 ID задачи в Bitrix: 158
```

## 🗂️ Структура проекта

```
bitrixPublic/
├── 📁 handlers/          # Обработчики сообщений
│   ├── commands.py       # Основные команды
│   ├── task_creation.py  # Создание задач
│   └── quick_tasks.py    # Быстрые команды
├── 📁 services/          # Бизнес-логика
│   ├── bitrix_client.py  # Клиент Bitrix24 API
│   └── task_formatter.py # Форматирование задач
├── 📁 models/            # Модели данных
│   └── states.py         # Состояния FSM
├── 📁 utils/             # Вспомогательные функции
│   └── helpers.py        # Утилиты
├── config.py             # Конфигурация
├── main.py               # Точка входа
└── requirements.txt      # Зависимости
```

## 🔧 Технические детали

### 🛠️ Технологии

| Технология | Назначение | Версия |
|------------|------------|---------|
| **Python** | Основной язык | 3.8+ |
| **Aiogram** | Telegram Bot Framework | 3.x |
| **Requests** | HTTP запросы к Bitrix24 | 2.31+ |
| **Python-dotenv** | Управление переменными окружения | 1.0+ |

### 📋 Поддерживаемые методы Bitrix24

- ✅ `tasks.task.add` - создание задач
- ✅ `tasks.task.list` - список задач  
- ✅ `tasks.task.get` - получение задачи
- ✅ `user.get` - список пользователей
- ✅ `sonet_group.get` - список проектов

## 🚀 Особенности

### ✨ Удобный интерфейс
- Интуитивные команды
- Подсказки и меню
- Быстрые ответы

### 🔒 Безопасность
- Валидация вводимых данных
- Обработка ошибок
- Безопасное хранение токенов

### ⚡ Производительность  
- Асинхронные операции
- Кэширование запросов
- Оптимизированные API вызовы

## 🐛 Отладка и логи

Бот автоматически логирует все операции:

```python
# Пример лога
2024-01-15 12:00:00 INFO - 🚀 Запуск бота...
2024-01-15 12:00:01 INFO - ✅ Подключение к Bitrix24 установлено
2024-01-15 12:00:05 INFO - ✅ Задача успешно создана (ID: 123)
```

## 🤝 Разработка

### Требования к окружению:
- Python 3.8 или выше
- Доступ к Bitrix24 с REST API
- Telegram Bot Token

### Запуск для разработки:

```bash
# Активируйте venv
source venv/bin/activate

# Запустите бота
python main.py
```

## ❓ Частые вопросы

**Q: Бот не отвечает на команды**
A: Проверьте, что BOT_TOKEN в .env файле указан правильно

**Q: Ошибка подключения к Bitrix24**
A: Убедитесь, что BITRIX_URL корректен и есть доступ к REST API

**Q: Не создаются задачи**
A: Проверьте права доступа в Bitrix24 и корректность ID исполнителя

## 📝 Лицензия

Этот проект распространяется под лицензией MIT.

## 👨‍💻 Автор

**Михаил** 

Разработано с ❤️ для автоматизации рабочих процессов

📫 **Связаться со мной:**

- Telegram: [@Mihaildenisenko](https://t.me/Mihaildenisenko)

---

<div align="center">

**⭐ Если этот проект вам помог, поставьте звездочку!**

*Для вопросов и предложений: создайте issue в репозитории*

</div>
